/**
 * Minified by jsDelivr using Terser v5.39.0.
 * Original file: /npm/qz-tray@2.2.5/qz-tray.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
"use strict";
/**
 * @version 2.2.5
 * @overview QZ Tray Connector
 * @license LGPL-2.1-only
 * <p/>
 * Connects a web client to the QZ Tray software.
 * Enables printing and device communication from javascript.
 */var qz=function(){Array.isArray||(Array.isArray=function(e){return"[object Array]"===Object.prototype.toString.call(e)}),Number.isInteger||(Number.isInteger=function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e});var e={VERSION:"2.2.5",DEBUG:!1,log:{trace:function(){e.DEBUG&&console.log.apply(console,arguments)},info:function(){console.info.apply(console,arguments)},warn:function(){console.warn.apply(console,arguments)},allay:function(){e.DEBUG&&console.warn.apply(console,arguments)},error:function(){console.error.apply(console,arguments)}},streams:{serial:"SERIAL",usb:"USB",hid:"HID",printer:"PRINTER",file:"FILE",socket:"SOCKET"},websocket:{connection:null,shutdown:!1,connectConfig:{host:["localhost","localhost.qz.io"],hostIndex:0,usingSecure:!0,protocol:{secure:"wss://",insecure:"ws://"},port:{secure:[8181,8282,8383,8484],insecure:[8182,8283,8384,8485],portIndex:0},keepAlive:60,retries:0,delay:0},setup:{findConnection:function(t,o,n){if(e.websocket.shutdown)n(new Error("Connection attempt cancelled by user"));else{if(t.port.secure.length)t.port.insecure.length||t.usingSecure||(e.log.trace("No insecure ports specified - forcing secure connection"),t.usingSecure=!0);else{if(!t.port.insecure.length)return void n(new Error("No ports have been specified to connect over"));t.usingSecure&&(e.log.error("No secure ports specified - forcing insecure connection"),t.usingSecure=!1)}var r,s=function(){if(e.websocket.shutdown)n(new Error("Connection attempt cancelled by user"));else{if(t.port.portIndex++,t.usingSecure&&t.port.portIndex>=t.port.secure.length||!t.usingSecure&&t.port.portIndex>=t.port.insecure.length){if(t.hostIndex>=t.host.length-1)return void n(new Error("Unable to establish connection with QZ"));t.hostIndex++,t.port.portIndex=0}e.websocket.setup.findConnection(t,o,n)}};r=t.usingSecure?t.protocol.secure+t.host[t.hostIndex]+":"+t.port.secure[t.port.portIndex]:t.protocol.insecure+t.host[t.hostIndex]+":"+t.port.insecure[t.port.portIndex];try{e.log.trace("Attempting connection",r),e.websocket.connection=new e.tools.ws(r)}catch(t){return e.log.error(t),void s()}null!=e.websocket.connection?(e.websocket.connection.established=!1,e.websocket.connection.onopen=function(s){if(!e.websocket.connection.established&&(e.log.trace(s),e.log.info("Established connection with QZ Tray on "+r),e.websocket.setup.openConnection({resolve:o,reject:n}),t.keepAlive>0)){var i=setInterval((function(){e.tools.isActive()&&e.websocket.connection.interval===i?e.websocket.connection.send("ping"):clearInterval(i)}),1e3*t.keepAlive);e.websocket.connection.interval=i}},e.websocket.connection.onclose=function(){e.websocket.connection&&"undefined"!=typeof navigator&&-1!=navigator.userAgent.indexOf("Safari")&&-1==navigator.userAgent.indexOf("Chrome")&&e.websocket.connection.onerror()},e.websocket.connection.onerror=function(t){e.log.trace(t),e.websocket.connection=null,s()}):n(new Error("Unable to create a websocket connection"))}},openConnection:function(t){function n(n){void 0===n&&(n=null),o.api.getVersion().then((function(t){e.websocket.connection.version=t,e.websocket.connection.semver=t.toLowerCase().replace(/-rc\./g,"-rc").split(/[\\+\\.-]/g);for(var o=0;o<e.websocket.connection.semver.length;o++){try{if(3==o&&0==e.websocket.connection.semver[o].toLowerCase().indexOf("rc")){e.websocket.connection.semver[o]=-e.websocket.connection.semver[o].replace(/\D/g,"");continue}e.websocket.connection.semver[o]=parseInt(e.websocket.connection.semver[o])}catch(e){}e.websocket.connection.semver.length<4&&(e.websocket.connection.semver[3]=0)}e.compatible.algorithm(!0)})).then((function(){e.websocket.connection.sendData({certificate:n,promise:t})}))}e.websocket.connection.established=!0,e.websocket.connection.onclose=function(t){for(var o in e.log.trace(t),e.websocket.connection=null,e.websocket.callClose(t),e.log.info("Closed connection with QZ Tray"),e.websocket.pendingCalls)e.websocket.pendingCalls.hasOwnProperty(o)&&e.websocket.pendingCalls[o].reject(new Error("Connection closed before response received"));null!=this.promise&&this.promise.resolve()},e.websocket.connection.onerror=function(t){e.websocket.callError(t)},e.websocket.connection.sendData=function(t){e.log.trace("Preparing object for websocket",t),null==t.timestamp&&(t.timestamp=Date.now(),"number"!=typeof t.timestamp&&(t.timestamp=(new Date).getTime())),null!=t.promise&&(t.uid=e.websocket.setup.newUID(),e.websocket.pendingCalls[t.uid]=t.promise),t.position={x:"undefined"!=typeof screen?(screen.availWidth||screen.width)/2+(screen.left||screen.availLeft||0):0,y:"undefined"!=typeof screen?(screen.availHeight||screen.height)/2+(screen.top||screen.availTop||0):0};try{if(null!=t.call&&null==t.signature&&e.security.needsSigned(t.call)){var o={call:t.call,params:t.params,timestamp:t.timestamp},n=e.tools.hash(e.tools.stringify(o));n.then||(n=e.tools.promise((function(e){e(n)}))),n.then((function(t){return e.security.callSign(t)})).then((function(o){e.log.trace("Signature for call",o),t.signature=o||"",t.signAlgorithm=e.security.signAlgorithm,e.signContent=void 0,e.websocket.connection.send(e.tools.stringify(t))})).catch((function(o){e.log.error("Signing failed",o),null!=t.promise&&(t.promise.reject(new Error("Failed to sign request")),delete e.websocket.pendingCalls[t.uid])}))}else e.log.trace("Signature for call",t.signature),e.websocket.connection.send(e.tools.stringify(t))}catch(o){e.log.error(o),null!=t.promise&&(t.promise.reject(o),delete e.websocket.pendingCalls[t.uid])}},e.websocket.connection.onmessage=function(t){var o=JSON.parse(t.data);if(null!=o.uid){e.log.trace("Received response from websocket",o);var n=e.websocket.pendingCalls[o.uid];null==n?e.log.allay("No promise found for returned response"):null!=o.error?n.reject(new Error(o.error)):n.resolve(o.result),delete e.websocket.pendingCalls[o.uid]}else if(null==o.type)e.websocket.connection.close(4003,"Connected to incompatible QZ Tray version");else switch(o.type){case e.streams.serial:o.event||(o.event=JSON.stringify({portName:o.key,output:o.data})),e.serial.callSerial(JSON.parse(o.event));break;case e.streams.socket:e.socket.callSocket(JSON.parse(o.event));break;case e.streams.usb:o.event||(o.event=JSON.stringify({vendorId:o.key[0],productId:o.key[1],output:o.data})),e.usb.callUsb(JSON.parse(o.event));break;case e.streams.hid:e.hid.callHid(JSON.parse(o.event));break;case e.streams.printer:e.printers.callPrinter(JSON.parse(o.event));break;case e.streams.file:e.file.callFile(JSON.parse(o.event));break;default:e.log.allay("Cannot determine stream type for callback",o)}},e.security.callCert().then(n).catch((function(o){e.log.warn("Failed to get certificate:",o),e.security.rejectOnCertFailure?t.reject(o):n(null)}))},newUID:function(){return(new Array(7).join("0")+(Math.random()*Math.pow(36,6)|0).toString(36)).slice(-6)}},dataPromise:function(t,o,n,r){return e.tools.promise((function(s,i){var a={call:t,promise:{resolve:s,reject:i},params:o,signature:n,timestamp:r};e.websocket.connection.sendData(a)}))},pendingCalls:{},errorCallbacks:[],callError:function(t){if(Array.isArray(e.websocket.errorCallbacks))for(var o=0;o<e.websocket.errorCallbacks.length;o++)e.websocket.errorCallbacks[o](t);else e.websocket.errorCallbacks(t)},closedCallbacks:[],callClose:function(t){if(Array.isArray(e.websocket.closedCallbacks))for(var o=0;o<e.websocket.closedCallbacks.length;o++)e.websocket.closedCallbacks[o](t);else e.websocket.closedCallbacks(t)}},printing:{defaultConfig:{bounds:null,colorType:"color",copies:1,density:0,duplex:!1,fallbackDensity:null,interpolation:"bicubic",jobName:null,legacy:!1,margins:0,orientation:null,paperThickness:null,printerTray:null,rasterize:!1,rotation:0,scaleContent:!0,size:null,units:"in",forceRaw:!1,encoding:null,spool:null}},serial:{serialCallbacks:[],callSerial:function(t){if(Array.isArray(e.serial.serialCallbacks))for(var o=0;o<e.serial.serialCallbacks.length;o++)e.serial.serialCallbacks[o](t);else e.serial.serialCallbacks(t)}},socket:{socketCallbacks:[],callSocket:function(t){if(Array.isArray(e.socket.socketCallbacks))for(var o=0;o<e.socket.socketCallbacks.length;o++)e.socket.socketCallbacks[o](t);else e.socket.socketCallbacks(t)}},usb:{usbCallbacks:[],callUsb:function(t){if(Array.isArray(e.usb.usbCallbacks))for(var o=0;o<e.usb.usbCallbacks.length;o++)e.usb.usbCallbacks[o](t);else e.usb.usbCallbacks(t)}},hid:{hidCallbacks:[],callHid:function(t){if(Array.isArray(e.hid.hidCallbacks))for(var o=0;o<e.hid.hidCallbacks.length;o++)e.hid.hidCallbacks[o](t);else e.hid.hidCallbacks(t)}},printers:{printerCallbacks:[],callPrinter:function(t){if(Array.isArray(e.printers.printerCallbacks))for(var o=0;o<e.printers.printerCallbacks.length;o++)e.printers.printerCallbacks[o](t);else e.printers.printerCallbacks(t)}},file:{fileCallbacks:[],callFile:function(t){if(Array.isArray(e.file.fileCallbacks))for(var o=0;o<e.file.fileCallbacks.length;o++)e.file.fileCallbacks[o](t);else e.file.fileCallbacks(t)}},security:{certHandler:function(e,t){t()},callCert:function(){return"function"==typeof e.security.certHandler.then?e.security.certHandler:"AsyncFunction"===e.security.certHandler.constructor.name?e.security.certHandler():e.tools.promise(e.security.certHandler)},signatureFactory:function(){return function(e){e()}},callSign:function(t){return"AsyncFunction"===e.security.signatureFactory.constructor.name?e.security.signatureFactory(t):e.tools.promise(e.security.signatureFactory(t))},signAlgorithm:"SHA1",rejectOnCertFailure:!1,needsSigned:function(e){return null!=e&&-1===["printers.getStatus","printers.stopListening","usb.isClaimed","usb.closeStream","usb.releaseDevice","hid.stopListening","hid.isClaimed","hid.closeStream","hid.releaseDevice","file.stopListening","getVersion"].indexOf(e)}},tools:{promise:function(t){return"undefined"!=typeof RSVP?new RSVP.Promise(t):"undefined"!=typeof Promise?new Promise(t):void e.log.error("Promise/A+ support is required.  See qz.api.setPromiseType(...)")},reject:function(t){return e.tools.promise((function(e,o){o(t)}))},stringify:function(e){var t=Array.prototype.toJSON;delete Array.prototype.toJSON;var o=JSON.stringify(e,(function(e,t){if("promise"!==e)return t}));return t&&(Array.prototype.toJSON=t),o},hash:function(t){return"undefined"!=typeof Sha256?Sha256.hash(t):e.SHA.hash(t)},ws:"undefined"!=typeof WebSocket?WebSocket:null,absolute:function(e){if("undefined"!=typeof window&&"function"==typeof document.createElement){var t=document.createElement("a");return t.href=e,t.href}return"object"==typeof exports&&require("path").resolve(e),e},relative:function(t){for(var o=0;o<t.length;o++)if(t[o].constructor===Object){var n=!1;t[o].data&&t[o].data.search&&0===t[o].data.search(/data:image\/\w+;base64,/)?(t[o].flavor="base64",t[o].data=t[o].data.replace(/^data:image\/\w+;base64,/,"")):t[o].flavor?["FILE","XML"].indexOf(t[o].flavor.toUpperCase())>-1&&(n=!0):(t[o].format&&["HTML","IMAGE","PDF","FILE","XML"].indexOf(t[o].format.toUpperCase())>-1||t[o].type&&(["PIXEL","IMAGE","PDF"].indexOf(t[o].type.toUpperCase())>-1&&!t[o].format||["HTML","PDF"].indexOf(t[o].type.toUpperCase())>-1&&(!t[o].format||"FILE"===t[o].format.toUpperCase())))&&(n=!0),n&&(t[o].data=e.tools.absolute(t[o].data)),t[o].options&&"string"==typeof t[o].options.overlay&&(t[o].options.overlay=e.tools.absolute(t[o].options.overlay))}},extend:function(t){"object"!=typeof t&&(t={});for(var o=1;o<arguments.length;o++){var n=arguments[o];if(n)for(var r in n)if(n.hasOwnProperty(r)){if(t===n[r])continue;var s;if(n[r]&&n[r].constructor&&n[r].constructor===Object)s=Array.isArray(n[r])?t[r]||[]:t[r]||{},t[r]=e.tools.extend(s,n[r]);else void 0!==n[r]&&(t[r]=n[r])}}return t},versionCompare:function(t,o,n,r){if(e.tools.assertActive()){var s=e.websocket.connection.semver;return s[0]!=t?s[0]-t:null!=o&&s[1]!=o?s[1]-o:null!=n&&s[2]!=n?s[2]-n:null!=r&&s.length>3&&s[3]!=r?Number.isInteger(s[3])&&Number.isInteger(r)?s[3]-r:s[3].toString().localeCompare(r.toString()):0}},isVersion:function(t,o,n,r){return 0==e.tools.versionCompare(t,o,n,r)},isActive:function(){return!e.websocket.shutdown&&null!=e.websocket.connection&&(e.websocket.connection.readyState===e.tools.ws.OPEN||e.websocket.connection.readyState===e.tools.ws.CONNECTING)},assertActive:function(){if(e.tools.isActive())return!0;throw new Error("A connection to QZ has not been established yet")},uint8ArrayToHex:function(e){return Array.from(e).map((function(e){return e.toString(16).padStart(2,"0")})).join("")},uint8ArrayToBase64:function(e){var t,o=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","0","1","2","3","4","5","6","7","8","9","+","/"],n="",r=e.length;for(t=2;t<r;t+=3)n+=o[e[t-2]>>2],n+=o[(3&e[t-2])<<4|e[t-1]>>4],n+=o[(15&e[t-1])<<2|e[t]>>6],n+=o[63&e[t]];return t===r+1&&(n+=o[e[t-2]>>2],n+=o[(3&e[t-2])<<4],n+="=="),t===r&&(n+=o[e[t-2]>>2],n+=o[(3&e[t-2])<<4|e[t-1]>>4],n+=o[(15&e[t-1])<<2],n+="="),n}},compatible:{data:function(t){for(var o=0;o<t.length;o++)if(t[o].constructor===Object&&t[o].data instanceof Uint8Array&&t[o].flavor){var n=t[o].flavor.toString().toUpperCase();switch(n){case"BASE64":t[o].data=e.tools.uint8ArrayToBase64(t[o].data);break;case"HEX":t[o].data=e.tools.uint8ArrayToHex(t[o].data);break;default:throw new Error("Uint8Array conversion to '"+n+"' is not supported.")}}if(e.tools.versionCompare(2,2,4)<0)for(o=0;o<t.length;o++)t[o].constructor===Object&&t[o].options&&"string"==typeof t[o].options.dotDensity&&(t[o].options.dotDensity=t[o].options.dotDensity.toLowerCase().replace("-legacy",""));if(e.tools.isVersion(2,0)){e.log.trace("Converting print data to v2.0 for "+e.websocket.connection.version);for(o=0;o<t.length;o++)t[o].constructor===Object&&(t[o].type&&"RAW"===t[o].type.toUpperCase()&&t[o].format&&"IMAGE"===t[o].format.toUpperCase()&&(t[o].flavor&&"BASE64"===t[o].flavor.toUpperCase()&&(t[o].data="data:image/compat;base64,"+t[o].data),t[o].flavor="IMAGE"),(t[o].type&&"RAW"===t[o].type.toUpperCase()||t[o].format&&"COMMAND"===t[o].format.toUpperCase())&&(t[o].format="RAW"),t[o].type=t[o].format,t[o].format=t[o].flavor,delete t[o].flavor)}},config:function(t,o){return e.tools.isVersion(2,0)&&(o.rasterize||(t.rasterize=!0)),e.tools.versionCompare(2,2)<0&&"undefined"!==t.forceRaw&&(t.altPrinting=t.forceRaw,delete t.forceRaw),e.tools.versionCompare(2,1,2,11)<0&&t.spool&&(t.spool.size&&(t.perSpool=t.spool.size,delete t.spool.size),t.spool.end&&(t.endOfDoc=t.spool.end,delete t.spool.end),delete t.spool),t},networking:function(t,o,n,r,s){return e.tools.isVersion(2,0)?e.tools.promise((function(i,a){e.websocket.dataPromise("websocket.getNetworkInfo",{hostname:t,port:o},n,r).then((function(e){i(void 0!==s?s(e):e)}),a)})):e.tools.promise((function(s,i){e.websocket.dataPromise("networking.device",{hostname:t,port:o},n,r).then((function(e){s({ipAddress:e.ip,macAddress:e.mac})}),i)}))},algorithm:function(t){return!(e.tools.isActive()&&e.websocket.connection.semver&&e.tools.isVersion(2,0))||(t||e.log.warn("Connected to an older version of QZ, alternate signature algorithms are not supported"),!1)}},SHA:{hash:function(t){for(var o=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],n=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],r=(t=e.SHA._utf8Encode(t)+String.fromCharCode(128)).length/4+2,s=Math.ceil(r/16),i=new Array(s),a=0;a<s;a++){i[a]=new Array(16);for(var c=0;c<16;c++)i[a][c]=t.charCodeAt(64*a+4*c)<<24|t.charCodeAt(64*a+4*c+1)<<16|t.charCodeAt(64*a+4*c+2)<<8|t.charCodeAt(64*a+4*c+3)}i[s-1][14]=8*(t.length-1)/Math.pow(2,32),i[s-1][14]=Math.floor(i[s-1][14]),i[s-1][15]=8*(t.length-1)&4294967295;var l,u,d,p,f,b,m,g,k=new Array(64);for(a=0;a<s;a++){for(var h=0;h<16;h++)k[h]=i[a][h];for(h=16;h<64;h++)k[h]=e.SHA._dev1(k[h-2])+k[h-7]+e.SHA._dev0(k[h-15])+k[h-16]&4294967295;l=n[0],u=n[1],d=n[2],p=n[3],f=n[4],b=n[5],m=n[6],g=n[7];for(h=0;h<64;h++){var w=g+e.SHA._sig1(f)+e.SHA._ch(f,b,m)+o[h]+k[h],v=e.SHA._sig0(l)+e.SHA._maj(l,u,d);g=m,m=b,b=f,f=p+w&4294967295,p=d,d=u,u=l,l=w+v&4294967295}n[0]=n[0]+l&4294967295,n[1]=n[1]+u&4294967295,n[2]=n[2]+d&4294967295,n[3]=n[3]+p&4294967295,n[4]=n[4]+f&4294967295,n[5]=n[5]+b&4294967295,n[6]=n[6]+m&4294967295,n[7]=n[7]+g&4294967295}return e.SHA._hexStr(n[0])+e.SHA._hexStr(n[1])+e.SHA._hexStr(n[2])+e.SHA._hexStr(n[3])+e.SHA._hexStr(n[4])+e.SHA._hexStr(n[5])+e.SHA._hexStr(n[6])+e.SHA._hexStr(n[7])},_rotr:function(e,t){return t>>>e|t<<32-e},_sig0:function(t){return e.SHA._rotr(2,t)^e.SHA._rotr(13,t)^e.SHA._rotr(22,t)},_sig1:function(t){return e.SHA._rotr(6,t)^e.SHA._rotr(11,t)^e.SHA._rotr(25,t)},_dev0:function(t){return e.SHA._rotr(7,t)^e.SHA._rotr(18,t)^t>>>3},_dev1:function(t){return e.SHA._rotr(17,t)^e.SHA._rotr(19,t)^t>>>10},_ch:function(e,t,o){return e&t^~e&o},_maj:function(e,t,o){return e&t^e&o^t&o},_hexStr:function(e){for(var t="",o=7;o>=0;o--)t+=(e>>>4*o&15).toString(16);return t},_unescape:function(e){return e.replace(/%(u[\da-f]{4}|[\da-f]{2})/gi,(function(e){if(e.length-1)return String.fromCharCode(parseInt(e.substring(e.length-3?2:1),16));var t=e.charCodeAt(0);return t<256?"%"+(0+t.toString(16)).slice(-2).toUpperCase():"%u"+("000"+t.toString(16)).slice(-4).toUpperCase()}))},_utf8Encode:function(t){return e.SHA._unescape(encodeURIComponent(t))}}};function t(t,o){this.config=e.tools.extend({},e.printing.defaultConfig),this._dirtyOpts={},this.setPrinter=function(e){"string"==typeof e&&(e={name:e}),this.printer=e},this.getPrinter=function(){return this.printer},this.reconfigure=function(t){for(var o in t)void 0!==t[o]&&(this._dirtyOpts[o]=!0);e.tools.extend(this.config,t)},this.getOptions=function(){return e.compatible.config(this.config,this._dirtyOpts)},this.setPrinter(t),this.reconfigure(o)}t.prototype.print=function(e,t,n){o.print(this,e,t,n)};var o={websocket:{isActive:function(){return e.tools.isActive()},connect:function(t){return e.tools.promise((function(o,n){if(e.websocket.connection){const t=e.websocket.connection.readyState;if(t===e.tools.ws.OPEN)return void n(new Error("An open connection with QZ Tray already exists"));if(t===e.tools.ws.CONNECTING)return void n(new Error("The current connection attempt has not returned yet"));if(t===e.tools.ws.CLOSING)return void n(new Error("Waiting for previous disconnect request to complete"))}if(e.tools.ws)if(e.tools.ws.CLOSED&&2!=e.tools.ws.CLOSED){null==t&&(t={}),"undefined"!=typeof location&&"https:"===location.protocol||void 0===t.usingSecure&&(e.log.trace("Disabling secure ports due to insecure page"),t.usingSecure=!1),void 0===t.host||Array.isArray(t.host)||(t.host=[t.host]),e.websocket.shutdown=!1;var r=function(s){var i=!1,a=function(){i||(i=!0,t&&s<t.retries?r(s+1):(e.websocket.connection=null,n.apply(null,arguments)))},c=function(){var n=e.tools.extend({},e.websocket.connectConfig,t);e.websocket.setup.findConnection(n,o,a)};0==s?c():setTimeout(c,1e3*t.delay)};r(0)}else n(new Error("Unsupported WebSocket version detected: HyBi-00/Hixie-76"));else n(new Error("WebSocket not supported by this browser"))}))},disconnect:function(){return e.tools.promise((function(t,o){null!=e.websocket.connection?e.tools.isActive()?(e.websocket.shutdown=!0,e.websocket.connection.promise={resolve:t,reject:o},e.websocket.connection.close()):o(new Error("Current connection is still closing")):o(new Error("No open connection with QZ Tray"))}))},setErrorCallbacks:function(t){e.websocket.errorCallbacks=t},setClosedCallbacks:function(t){e.websocket.closedCallbacks=t},getNetworkInfo:e.compatible.networking,getConnectionInfo:function(){if(e.tools.assertActive()){var t=e.websocket.connection.url.split(/[:\/]+/g);return{socket:t[0],host:t[1],port:+t[2]}}}},printers:{getDefault:function(t,o){return e.websocket.dataPromise("printers.getDefault",null,t,o)},find:function(t,o,n){return e.websocket.dataPromise("printers.find",{query:t},o,n)},details:function(){return e.websocket.dataPromise("printers.detail")},startListening:function(t,o){Array.isArray(t)||(t=[t]);var n={printerNames:t};return o&&1==o.jobData&&(n.jobData=!0),o&&o.maxJobData&&(n.maxJobData=o.maxJobData),o&&o.flavor&&(n.flavor=o.flavor),e.websocket.dataPromise("printers.startListening",n)},clearQueue:function(t){return"object"!=typeof t&&(t={printerName:t}),e.websocket.dataPromise("printers.clearQueue",t)},stopListening:function(){return e.websocket.dataPromise("printers.stopListening")},getStatus:function(){return e.websocket.dataPromise("printers.getStatus")},setPrinterCallbacks:function(t){e.printers.printerCallbacks=t}},configs:{setDefaults:function(t){e.tools.extend(e.printing.defaultConfig,t)},create:function(e,o){return new t(e,o)}},print:function(t,o){var n=!1,r=[],s=[];arguments.length>=3&&("boolean"==typeof arguments[2]?(n=arguments[2],arguments.length>=5&&(r=arguments[3],s=arguments[4])):arguments.length>=4&&(r=arguments[2],s=arguments[3]),r&&!Array.isArray(r)&&(r=[r]),s&&!Array.isArray(s)&&(s=[s])),Array.isArray(t)||(t=[t]),Array.isArray(o[0])||(o=[o]);for(var i=0;i<o.length;i++)e.tools.relative(o[i]),e.compatible.data(o[i]);for(var a=[],c=0;c<t.length||c<o.length;c++)!function(n){var i={config:t[Math.min(n,t.length-1)],data:o[Math.min(n,o.length-1)],signature:r[n],timestamp:s[n]};a.push((function(){return o={printer:(t=i).config.getPrinter(),options:t.config.getOptions(),data:t.data},e.websocket.dataPromise("print",o,t.signature,t.timestamp);var t,o}))}(c);var l=null;if(n){var u=[];l=function(e){u.push(e)},a.push((function(){return e.tools.promise((function(e,t){u.length?t(u):e()}))}))}var d=null;return a.reduce((function(e,t){return d=e.catch(l).then(t)}),e.tools.promise((function(e){e()}))),d},serial:{findPorts:function(){return e.websocket.dataPromise("serial.findPorts")},setSerialCallbacks:function(t){e.serial.serialCallbacks=t},openPort:function(t,o){var n={port:t,options:o};return e.websocket.dataPromise("serial.openPort",n)},sendData:function(t,o,n){e.tools.versionCompare(2,1,0,12)>=0&&("object"!=typeof o&&(o={data:o,type:"PLAIN"}),o.type&&"FILE"==o.type.toUpperCase()&&(o.data=e.tools.absolute(o.data)));var r={port:t,data:o,options:n};return e.websocket.dataPromise("serial.sendData",r)},closePort:function(t){return e.websocket.dataPromise("serial.closePort",{port:t})}},socket:{open:function(t,o,n){var r={host:t,port:o,options:n};return e.websocket.dataPromise("socket.open",r)},close:function(t,o){var n={host:t,port:o};return e.websocket.dataPromise("socket.close",n)},sendData:function(t,o,n){"object"!=typeof n&&(n={data:n,type:"PLAIN"});var r={host:t,port:o,data:n};return e.websocket.dataPromise("socket.sendData",r)},setSocketCallbacks:function(t){e.socket.socketCallbacks=t}},usb:{listDevices:function(t){return e.websocket.dataPromise("usb.listDevices",{includeHubs:t})},listInterfaces:function(t){return"object"!=typeof t&&(t={vendorId:arguments[0],productId:arguments[1]}),e.websocket.dataPromise("usb.listInterfaces",t)},listEndpoints:function(t){return"object"!=typeof t&&(t={vendorId:arguments[0],productId:arguments[1],interface:arguments[2]}),e.websocket.dataPromise("usb.listEndpoints",t)},setUsbCallbacks:function(t){e.usb.usbCallbacks=t},claimDevice:function(t){return"object"!=typeof t&&(t={vendorId:arguments[0],productId:arguments[1],interface:arguments[2]}),e.websocket.dataPromise("usb.claimDevice",t)},isClaimed:function(t){return"object"!=typeof t&&(t={vendorId:arguments[0],productId:arguments[1]}),e.websocket.dataPromise("usb.isClaimed",t)},sendData:function(t){return"object"!=typeof t&&(t={vendorId:arguments[0],productId:arguments[1],endpoint:arguments[2],data:arguments[3]}),e.tools.versionCompare(2,1,0,12)>=0&&("object"!=typeof t.data&&(t.data={data:t.data,type:"PLAIN"}),t.data.type&&"FILE"==t.data.type.toUpperCase()&&(t.data.data=e.tools.absolute(t.data.data))),e.websocket.dataPromise("usb.sendData",t)},readData:function(t){return"object"!=typeof t&&(t={vendorId:arguments[0],productId:arguments[1],endpoint:arguments[2],responseSize:arguments[3]}),e.websocket.dataPromise("usb.readData",t)},openStream:function(t){return"object"!=typeof t&&(t={vendorId:arguments[0],productId:arguments[1],endpoint:arguments[2],responseSize:arguments[3],interval:arguments[4]}),e.websocket.dataPromise("usb.openStream",t)},closeStream:function(t){return"object"!=typeof t&&(t={vendorId:arguments[0],productId:arguments[1],endpoint:arguments[2]}),e.websocket.dataPromise("usb.closeStream",t)},releaseDevice:function(t){return"object"!=typeof t&&(t={vendorId:arguments[0],productId:arguments[1]}),e.websocket.dataPromise("usb.releaseDevice",t)}},hid:{listDevices:function(){return e.websocket.dataPromise("hid.listDevices")},startListening:function(){return e.websocket.dataPromise("hid.startListening")},stopListening:function(){return e.websocket.dataPromise("hid.stopListening")},setHidCallbacks:function(t){e.hid.hidCallbacks=t},claimDevice:function(t){return"object"!=typeof t&&(t={vendorId:arguments[0],productId:arguments[1]}),e.websocket.dataPromise("hid.claimDevice",t)},isClaimed:function(t){return"object"!=typeof t&&(t={vendorId:arguments[0],productId:arguments[1]}),e.websocket.dataPromise("hid.isClaimed",t)},sendData:function(t){if("object"!=typeof t&&(t={vendorId:arguments[0],productId:arguments[1],data:arguments[2],endpoint:arguments[3]}),e.tools.versionCompare(2,1,0,12)>=0)"object"!=typeof t.data&&(t.data={data:t.data,type:"PLAIN"}),t.data.type&&"FILE"==t.data.type.toUpperCase()&&(t.data.data=e.tools.absolute(t.data.data));else if("object"==typeof t.data){if("PLAIN"!==t.data.type.toUpperCase()||"string"!=typeof t.data.data)return e.tools.reject(new Error("Data format is not supported with connected QZ Tray version "+e.websocket.connection.version));t.data=t.data.data}return e.websocket.dataPromise("hid.sendData",t)},readData:function(t){return"object"!=typeof t&&(t={vendorId:arguments[0],productId:arguments[1],responseSize:arguments[2]}),e.websocket.dataPromise("hid.readData",t)},sendFeatureReport:function(t){return e.websocket.dataPromise("hid.sendFeatureReport",t)},getFeatureReport:function(t){return e.websocket.dataPromise("hid.getFeatureReport",t)},openStream:function(t){return"object"!=typeof t&&(t={vendorId:arguments[0],productId:arguments[1],responseSize:arguments[2],interval:arguments[3]}),e.websocket.dataPromise("hid.openStream",t)},closeStream:function(t){return"object"!=typeof t&&(t={vendorId:arguments[0],productId:arguments[1]}),e.websocket.dataPromise("hid.closeStream",t)},releaseDevice:function(t){return"object"!=typeof t&&(t={vendorId:arguments[0],productId:arguments[1]}),e.websocket.dataPromise("hid.releaseDevice",t)}},file:{list:function(t,o){var n=e.tools.extend({path:t},o);return e.websocket.dataPromise("file.list",n)},read:function(t,o){var n=e.tools.extend({path:t},o);return e.websocket.dataPromise("file.read",n)},write:function(t,o){var n=e.tools.extend({path:t},o);return e.websocket.dataPromise("file.write",n)},remove:function(t,o){var n=e.tools.extend({path:t},o);return e.websocket.dataPromise("file.remove",n)},startListening:function(t,o){o&&void 0!==o.include&&!Array.isArray(o.include)&&(o.include=[o.include]),o&&void 0!==o.exclude&&!Array.isArray(o.exclude)&&(o.exclude=[o.exclude]);var n=e.tools.extend({path:t},o);return e.websocket.dataPromise("file.startListening",n)},stopListening:function(t,o){var n=e.tools.extend({path:t},o);return e.websocket.dataPromise("file.stopListening",n)},setFileCallbacks:function(t){e.file.fileCallbacks=t}},networking:{device:function(t,o){return e.tools.isVersion(2,0)?e.compatible.networking(t,o,null,null,(function(e){return{ip:e.ipAddress,mac:e.macAddress}})):e.websocket.dataPromise("networking.device",{hostname:t,port:o})},hostname:function(t,o){return e.tools.versionCompare(2,2,2)<0?e.tools.promise((function(n,r){e.websocket.dataPromise("networking.device",{hostname:t,port:o}).then((function(e){console.log(e),n(e.hostname)}))})):e.websocket.dataPromise("networking.hostname")},devices:function(t,o){return e.tools.isVersion(2,0)?e.compatible.networking(t,o,null,null,(function(e){return[{ip:e.ipAddress,mac:e.macAddress}]})):e.websocket.dataPromise("networking.devices",{hostname:t,port:o})}},security:{setCertificatePromise:function(t,o){e.security.certHandler=t,e.security.rejectOnCertFailure=!(!o||!o.rejectOnFailure)},setSignaturePromise:function(t){e.security.signatureFactory=t},setSignatureAlgorithm:function(t){e.compatible.algorithm()&&(["SHA1","SHA256","SHA512"].indexOf(t.toUpperCase())<0?e.log.error("Signing algorithm '"+t+"' is not supported."):e.security.signAlgorithm=t)},getSignatureAlgorithm:function(){return e.security.signAlgorithm}},api:{showDebug:function(t){return e.DEBUG=t},getVersion:function(){return e.websocket.dataPromise("getVersion")},isVersion:e.tools.isVersion,isVersionGreater:function(t,o,n,r){return e.tools.versionCompare(t,o,n,r)>0},isVersionLess:function(t,o,n,r){return e.tools.versionCompare(t,o,n,r)<0},setPromiseType:function(t){e.tools.promise=t},setSha256Type:function(t){e.tools.hash=t},setWebSocketType:function(t){e.tools.ws=t}},version:e.VERSION};return o}();"function"==typeof define&&define.amd?define(qz):"object"==typeof exports?module.exports=qz:window.qz=qz;
//# sourceMappingURL=/sm/1a4ee1390ea415251b86da06e30919b8ad49678caa5c0f6be1d99caf21bb4ce8.map